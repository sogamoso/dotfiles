#!/usr/bin/env bash
set -euo pipefail

REPO_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

case "$(uname -s)" in
  Darwin)
    bash "$REPO_DIR/install/macos/omadots.sh"
    bash "$REPO_DIR/install/macos/setup.sh"
    bash "$REPO_DIR/install/macos/alacritty.sh"
    ;;
  *)
    echo "Unsupported OS"
    exit 1
    ;;
esac

# Stow personal configs (restores anything Omadots overwrote)
bash "$REPO_DIR/install/stow.sh"

# Tailscale
if ! tailscale status &>/dev/null; then
  echo "Tailscale is not connected. Run: tailscale up --ssh"
fi

cat <<'EOF'

──────────────────────────────────────────
  Manual post-setup steps
──────────────────────────────────────────
  1. Create nine default workspaces (F3 → + button)
  2. Disable Keyboard Shortcuts for Mission Control + Spotlight
     (System Settings → Keyboard → Keyboard Shortcuts)
  3. Enable "Switch to Desktop" shortcuts on ⌘1–⌘9
  4. Import Raycast config from ~/.config/raycast/Raycast.rayconfig (pw: 12345678)
  5. gh auth login
  6. Log out and back in (⌘⇧Q)
──────────────────────────────────────────

EOF

exec zsh -l
