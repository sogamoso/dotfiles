#!/usr/bin/env bash
set -euo pipefail

REPO_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

# OS specific setup
case "$(uname -s)" in
  Darwin)
    bash "$REPO_DIR/install/macos.sh"
    ;;
  *)
    echo "Unsupported OS for now"
    exit 1
    ;;
esac

# Dotfiles via GNU stow
bash "$REPO_DIR/install/stow.sh"

# Tailscale
if ! tailscale status &>/dev/null; then
  echo "âš  Tailscale is not connected. Run: tailscale up --ssh"
fi

# Fresh shell process
exec zsh -l
